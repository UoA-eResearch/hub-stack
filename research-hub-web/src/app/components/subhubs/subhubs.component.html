<!-- Displaying all subhubs -->
<app-collection-list *ngIf="allSubHubs$ | async as allSubHubs" [collection]="allSubHubs"></app-collection-list>

<!-- Displaying a singular subhub -->
<div class="results" *ngIf="subhub$ | async as subHubData">
    <div *ngFor="let subhub of subHubData.items; let i = index">

        <!-- Dynamic Banner -->
        <div 
            class="banner-container"
            [style.background]="subhub.bannerImage ? 'url(' + subhub.bannerImage.url + ') no-repeat' : 'url(https://images.unsplash.com/photo-1528197434556-984e7d06ecd5?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1950&q=80)'">
            <div 
                class="banner-content" 
                *ngIf="subhub.viewType == 'View 1'">

                <!-- Title and Summary (View 1) -->
                <h1 
                    class="subhub-title" 
                    ngClass.sm="subhub-title-sm" 
                    ngClass.xs="subhub-title-xs"
                    style="color: white">
                        {{ subhub.title }}
                </h1>

                <h3 
                    class="subhub-summary" 
                    ngClass.sm="subhub-summary-sm" 
                    ngClass.xs="subhub-summary-xs" 
                    style="color: #bdbdbd">
                        <hr style="width: 60%;background-color: #747474;border: none;height: 1px;"/>
                        <small>{{ subhub.summary }}</small>
                </h3>
            </div>
        </div>  


        <ng-template #breadcrumbs>
            <div id="breadcrumbs" class="breadcrumbs" *ngIf="!!parentSubHubs">
                <span class="breadcrumb-subhub" *ngFor="let parentSubHub of parentSubHubs.slice().reverse()">
                    <a [routerLink]="'/subhub/' + parentSubHub.slug">{{ parentSubHub.title }}</a>
                </span>
                <span id="breadcrumb-current-page">{{ subhub.title }}</span>
            </div>
        </ng-template>

        <!-- <ng-template #jsonData>
            <mat-card>
                <mat-expansion-panel>
                    <mat-expansion-panel-header>
                        <mat-panel-title> JSON Result </mat-panel-title>
                        <mat-panel-description>Click to see raw JSON</mat-panel-description>
                    </mat-expansion-panel-header>
                    <pre><code>{{ subHubData | json}}</code></pre>
                </mat-expansion-panel>
            </mat-card>
        </ng-template> -->

        <div [ngSwitch]="subhub.viewType">
            <div *ngSwitchCase="'View 1'">
                <div>
                    <!-- Breadcrumbs -->
                    <ng-container *ngTemplateOutlet="breadcrumbs"></ng-container>

                    <!-- Body Content -->
                    <div 
                        fxLayout="row wrap"
                        fxLayout.sm="column wrap"
                        fxLayout.xs="column wrap"  
                        fxLayoutGap="2%">
                        
                        <!-- Main Body -->
                        <div #subhubContent fxFlex="65%">
                            <div #subhubContent
                                style="margin-bottom: 200px;" 
                                [innerHTML]="subhub.body.json | richTextToHTML">
                            </div>
                        </div>

                        <!-- SubHub Children -->
                        <div #subhubChildPages fxFlex="30%">
                            <h4>Pages in this SubHub</h4>
                            <div fxLayout="column wrap">
                                <div 
                                    *ngFor="let subHub of subhub.subhubPagesCollection.items">
                                        <a [routerLink]="'/' + subHub['__typename'].toLowerCase() + '/' + subHub['slug']">
                                            <mat-card >
                                                <span class="card-title">
                                                    {{ subHub.title}}
                                                </span> 
                                                <br/>
                                                <span class="related-item-summary">
                                                    {{ subHub.summary }}
                                                </span>
                                            </mat-card>
                                        </a>
                                </div>
                            </div>
                            <hr/>

                            <!-- Keywords -->
                            <h4>Keywords</h4>
                            <mat-card-subtitle fxLayout="row wrap">
                                <span *ngFor="let keyword of subhub.keywords">
                                    <mat-card 
                                        fxLayout="row" 
                                        class="keyword-card">
                                            {{ keyword | humanCase }}
                                    </mat-card>
                                </span>
                            </mat-card-subtitle>
                        </div>
                    </div>
                </div>
            </div>

            <div *ngSwitchCase="'View 2'">
                <div>
                    <!-- Breadrcumbs -->
                    <ng-container *ngTemplateOutlet="breadcrumbs"></ng-container>

                    <!-- Title and Summary -->
                    <div>
                        <h1 
                            class="subhub-title" 
                            ngClass.sm="subhub-title-sm" 
                            ngClass.xs="subhub-title-xs">
                            {{ subhub.title }}
                        </h1>
                        <h3 
                            class="subhub-summary" 
                            ngClass.sm="subhub-summary-sm" 
                            ngClass.xs="subhub-summary-xs">
                            {{ subhub.summary }}
                        </h3>
                        <hr style="margin: 25px 0px;"/>
                    </div>
            
                    <!-- Body Content -->

                    <!-- Main Body -->
                    <div #subhubContent
                        style="margin-bottom: 200px;" 
                        [innerHTML]="subhub.body.json | richTextToHTML">
                    </div>
            
                    <!-- SubHub Children -->
                    <div #subhubChildPages>
                        <h4>Pages in this SubHub</h4>
                        <div 
                            fxLayout="row wrap"
                            fxLayoutGap="1%">
                            <div 
                                style="margin-bottom: 20px;" 
                                *ngFor="let subHub of subhub.subhubPagesCollection.items">
                                    <a [routerLink]="'/' + subHub['__typename'].toLowerCase() + '/' + subHub['slug']">
                                        <mat-card >
                                            <span class="card-title">
                                                {{ subHub.title}}
                                            </span> 
                                            <br/>
                                            <span class="related-item-summary">
                                                {{ subHub.summary }}
                                            </span>
                                        </mat-card>
                                    </a>
                            </div>
                        </div>
                    </div>
                    <hr />

                    <!-- Keywords -->
                    <h4>Keywords</h4>

                    <mat-card-subtitle 
                        fxLayout="row wrap"> 
                        <span *ngFor="let keyword of subhub.keywords">
                            <mat-card 
                                fxLayout="row" 
                                class="keyword-card">
                                    {{ keyword | humanCase }}
                            </mat-card>
                        </span>
                    </mat-card-subtitle>
                </div>
            </div>
        </div>
    </div>
</div>