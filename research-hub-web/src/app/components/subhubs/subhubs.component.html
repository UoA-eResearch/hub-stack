<!-- Displaying all SubHubs -->
<div
    *ngIf="allSubHubs$ | async as allSubHubs" 
    class="site-padding margin-bottom top-padding" 
    ngClass.xs="site-padding-xs margin-bottom-xs top-padding" 
    ngClass.sm="site-padding-sm margin-bottom-sm top-padding">
    <app-collection-list [collection]="allSubHubs"></app-collection-list>
</div>

<!-- Displaying an individual SubHub -->
<div 
    style="overflow-x: hidden"
    class="results" 
    *ngIf="currentSubHub$ | async as subhub">
    <div>

        <!-- Templates -->
        <ng-template #subHubChildren>
            <app-large-cards [contentItem]="subhub"></app-large-cards>
        </ng-template>

        <ng-template #breadcrumbs>
            <app-breadcrumbs 
                [contentItem]="parentSubHubs" 
                [title]="subhub.title">
            </app-breadcrumbs>
        </ng-template>

        <ng-template #relatedItems let-hide="hideImage">
            <app-cards 
                [hideImage]="hide"
                [title]="'You might be interested in'" 
                [contentItem]="subhub.relatedItemsCollection">
            </app-cards>
        </ng-template>

        <ng-template #dynamicBanner>
            <div 
                class="banner-container"
                [style]="subhub.banner? 'background: url(' + subhub.banner.url + ') no-repeat' : subhub.viewType == 'View 2' ? 'display: none;' : 'min-height: 0px'">
            </div>
        </ng-template>

        <!-- View 1 -->
        <div [ngSwitch]="subhub.viewType">
            <div *ngSwitchCase="'View 1'">
                <div 
                class="banner-container"
                [style]="subhub.banner ? 'background: url(' + subhub.banner.url + ') no-repeat' : subhub.viewType == 'View 2' ? 'display: none;' : 'min-height: 0px'">
                    <div
                        class="banner-content" 
                        [style]="subhub.banner ? '' : 'margin: 3vh 0;'"
                        *ngIf="subhub.viewType == 'View 1'">

                        <!-- Title and Summary for View 1 -->
                        <!-- Title -->
                        <h1 
                            class="content-title" 
                            ngClass.sm="content-title-sm" 
                            ngClass.xs="content-title-xs"
                            [style.color]="subhub.banner ? subhub.viewType == 'View 1' ? 'white' : '' : ''">
                                {{ subhub.title }}
                        </h1>

                        <!-- Summary -->
                        <h3 
                            class="content-summary" 
                            ngClass.sm="content-summary-sm" 
                            ngClass.xs="content-summary-xs"
                            [style.color]="subhub.banner ? subhub.viewType == 'View 1' ? 'white' : '' : ''">
                                <small>{{ subhub.summary }}</small>
                        </h3>
                    </div>
                </div>

                <!-- Breadcrumbs -->
                <ng-container *ngTemplateOutlet="breadcrumbs"></ng-container>

                <div
                    class="site-padding top-padding"
                    ngClass.sm="site-padding-sm top-padding"
                    ngClass.xs="site-padding-xs top-padding">

                    <!-- Body Content -->
                    <div 
                        fxLayout="row wrap"
                        fxLayout.sm="column wrap"
                        fxLayout.xs="column wrap"
                        fxLayoutGap="2%"
                        fxLayoutAlign="space-between">
                        
                        <!-- Main Body -->
                        <div fxFlex="65%" class="section">
                            <ngx-contentful-rich-text
                                class="section-2"
                                style="word-break:break-word;" 
                                [document]="subhub.bodyText.json"
                                [nodeRenderers]="nodeRenderers">
                            </ngx-contentful-rich-text>
                        </div>

                        <!-- Related Items and Keywords -->
                        <div fxFlex="30%">

                            <!-- Related Items -->
                            <div *ngIf="subhub.relatedItemsCollection.items.length > 0">
                                <ng-container *ngTemplateOutlet="relatedItems"></ng-container>
                            </div>

                            <!-- Keywords -->
                            <app-keywords [contentItem]="subhub.keywords"></app-keywords>
                        </div>
                    </div>
                </div>

                <!-- SubHub Children -->
                <div class="subhub-children section-2">
                    <ng-container *ngTemplateOutlet="subHubChildren"></ng-container>
                </div>

            </div>

            <!-- View 2 -->
            <div *ngSwitchCase="'View 2'">
                <ng-container *ngTemplateOutlet="dynamicBanner"></ng-container>

                <div>

                    <!-- Breadcrumbs -->
                    <ng-container *ngTemplateOutlet="breadcrumbs"></ng-container>

                    <!-- Title and Summary -->
                    <div>
                        <h1
                            class="content-title site-padding" 
                            ngClass.sm="content-title-sm site-padding-sm" 
                            ngClass.xs="content-title-xs site-padding-xs">
                            {{ subhub.title }}
                        </h1>
                        <h3 
                            class="content-summary site-padding" 
                            ngClass.sm="content-summary-sm site-padding-sm" 
                            ngClass.xs="content-summary-xs site-padding-xs">
                            {{ subhub.summary }}
                            <hr class="section"/>
                        </h3>
                    </div>
            
                    <!-- Body Content -->
                    <!-- Main Body -->
                    <div 
                        class="main-body site-padding"
                        ngClass.sm="site-padding-sm"
                        ngClass.xs="site-padding-xs">
                        <ngx-contentful-rich-text
                            class="section-2"
                            style="word-break:break-word;" 
                            [document]="subhub.bodyText.json"
                            [nodeRenderers]="nodeRenderers">
                        </ngx-contentful-rich-text>
                    </div>
            
                    <!-- SubHub Children -->
                    <div class="subhub-children section-2">
                        <ng-container *ngTemplateOutlet="subHubChildren"></ng-container>
                    </div>

                    <!-- Related Items -->
                    <div 
                        class="site-padding"
                        ngClass.sm="site-padding-sm"
                        ngClass.xs="site-padding-xs">
                        <div *ngIf="subhub.relatedItemsCollection.items.length > 0">
                            <ng-container *ngTemplateOutlet="relatedItems; context: { hideImage: true }"></ng-container>
                        </div>
                    </div>

                    <!-- Keywords -->
                    <div
                        class="site-padding"
                        ngClass.sm="site-padding-sm"
                        ngClass.xs="site-padding-xs">
                        
                        <!-- Keywords -->
                        <app-keywords [contentItem]="subhub.keywords"></app-keywords>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>