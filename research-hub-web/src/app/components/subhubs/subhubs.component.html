<!-- Displaying all subhubs -->
<app-collection-list *ngIf="allSubHubs$ | async as allSubHubs" [collection]="allSubHubs"></app-collection-list>

<!-- Displaying a singular subhub -->
<div class="results" *ngIf="subhub$ | async as subHubData">
    <div *ngFor="let subhub of subHubData.items; let i = index">

        <ng-template #breadcrumbs>
            <div id="breadcrumbs" class="breadcrumbs" *ngIf="!!parentSubHubs">
                <span class="breadcrumb-subhub" *ngFor="let parentSubHub of parentSubHubs.slice().reverse()">
                    <a [routerLink]="'/subhub/' + parentSubHub.slug">{{ parentSubHub.title }}</a>
                </span>
                <span id="breadcrumb-current-page">{{ subhub.title }}</span>
            </div>
        </ng-template>

        <!-- <ng-template #jsonData>
            <mat-card>
                <mat-expansion-panel>
                    <mat-expansion-panel-header>
                        <mat-panel-title> JSON Result </mat-panel-title>
                        <mat-panel-description>Click to see raw JSON</mat-panel-description>
                    </mat-expansion-panel-header>
                    <pre><code>{{ subHubData | json}}</code></pre>
                </mat-expansion-panel>
            </mat-card>
        </ng-template> -->

        <ng-template #cardHeader>
            <h1 
                class="subhub-title" 
                ngClass.sm="subhub-title-sm" 
                ngClass.xs="subhub-title-xs">
                {{ subhub.title }}
            </h1>
            <h3 
                class="subhub-summary" 
                ngClass.sm="subhub-summary-sm" 
                ngClass.xs="subhub-summary-xs">
                {{ subhub.summary }}
            </h3>

            <hr style="margin: 25px 0px;"/>
        </ng-template>


        <ng-template #subhubContent>
            <div 
                class="content" 
                *ngFor="let contentItem of subhub.body.json.content as c">
                <div 
                    *ngIf="contentItem.content[0]">
                        {{ contentItem.content[0].value }}
                </div>
            </div>
        </ng-template>

        <ng-template #subhubChildPages>
            <h4>Pages in this SubHub<hr/></h4>
            <div 
                fxLayout="row wrap"
                fxLayoutGap="1%">
                <div 
                    style="margin-bottom: 20px;" 
                    *ngFor="let subHub of subhub.subhubPagesCollection.items">
                        <a [routerLink]="'/' + subHub['__typename'].toLowerCase() + '/' + subHub['slug']">
                            <mat-card >
                                <span class="card-title">
                                    {{ subHub.title}}
                                </span> 
                                <br/>
                                <span class="related-item-summary">
                                    {{ subHub.summary }}
                                </span>
                            </mat-card>
                        </a>
                </div>
            </div>
        </ng-template>

        <div [ngSwitch]="subhub.viewType">
            <div *ngSwitchCase="'View 1'">
                <div class="view1">
                    <ng-container *ngTemplateOutlet="breadcrumbs"></ng-container>
                    <!-- <ng-container *ngTemplateOutlet="jsonData"></ng-container> -->
                    <ng-container *ngTemplateOutlet="cardHeader"></ng-container>
                    <ng-container *ngTemplateOutlet="subhubContent"></ng-container>
                    <ng-container *ngTemplateOutlet="subhubChildPages"></ng-container>
                </div>
            </div>
            <div *ngSwitchCase="'View 2'">
                <div class="view2">
                    <ng-container *ngTemplateOutlet="breadcrumbs"></ng-container>
                    <!-- <ng-container *ngTemplateOutlet="jsonData"></ng-container> -->
                    <ng-container *ngTemplateOutlet="cardHeader"></ng-container>
                    <ng-container *ngTemplateOutlet="subhubContent"></ng-container>
                    <ng-container *ngTemplateOutlet="subhubChildPages"></ng-container>
                </div>
            </div>
            <!-- <div *ngSwitchDefault>
                <ng-container *ngTemplateOutlet="breadcrumbs"></ng-container>
                <ng-container *ngTemplateOutlet="jsonData"></ng-container>
                <ng-container *ngTemplateOutlet="cardHeader"></ng-container>
                <ng-container *ngTemplateOutlet="subhubContent"></ng-container>
                <ng-container *ngTemplateOutlet="subhubChildPages"></ng-container>
            </div> -->
        </div>
    </div>
</div>