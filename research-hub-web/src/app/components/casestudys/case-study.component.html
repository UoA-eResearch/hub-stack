<!-- If we're displaying a collection of caseStudys-->
<div
  *ngIf="allCaseStudies$ | async as allCaseStudies"
  class="site-padding margin-bottom top-padding"
  ngClass.lt-md="site-padding-mobile margin-bottom top-padding"
>
  <app-collection-list [collection]="allCaseStudies"></app-collection-list>
</div>

<div id="case-study-container" *ngIf="caseStudy | async as caseStudy">
  <div
    class="banner-container"
    [ngClass]="
      bannerImageUrl === undefined
        ? ''
        : isMobile
        ? 'mobile-banner'
        : 'standard-banner'
    "
    [ngStyle]="
      bannerImageUrl && { 'background-image': 'url(' + bannerImageUrl + ')' }
    "
  >
    <div class="banner-content">
      <!-- Title -->
      <h1
        role="heading"
        aria-level="1"
        class="content-title"
        ngClass.lt-md="content-title-mobile"
        [style]="caseStudy.banner ? bannerTextStyling : ''"
      >
        {{ caseStudy.title }}
      </h1>

      <!-- Maori Proverb -->
      <h2
        aria-level="2"
        *ngIf="caseStudy.maoriProverb"
        class="maori-proverb"
        [style]="caseStudy.banner ? bannerTextStyling : ''"
      >
        <hr />
        {{ caseStudy.maoriProverb }}
        <hr />
      </h2>

      <!-- Summary -->
      <p
        class="content-summary"
        ngClass.sm="content-summary-sm"
        ngClass.xs="content-summary-xs"
        [style]="caseStudy.banner ? bannerTextStyling : ''"
      >
        <small>{{ caseStudy.summary }}</small>
      </p>
    </div>
  </div>

  <div class="site-padding" ngClass.lt-md="site-padding-mobile">
    <app-breadcrumbs
      [contentItem]="parentSubHubs"
      [title]="caseStudy.title"
    ></app-breadcrumbs>

    <div
      fxLayout="row"
      fxLayoutAlign="space-between"
      fxLayout.lt-md="column wrap"
      fxLayoutGap="5%"
    >
      <!-- caseStudy Body and References -->
      <div fxFlexOrder="2" fxFlexOrder.xs="1" fxFlex>
        <ngx-contentful-rich-text
          id="bodyMediaList"
          class="section-2"
          style="word-break: break-word"
          [document]="caseStudy.bodyText?.json"
          [nodeRenderers]="nodeRenderers"
        ></ngx-contentful-rich-text>
        <app-case-study-references></app-case-study-references>
      </div>

      <!-- Extra Links -->
      <div
        *ngIf="
          caseStudy.relatedDocsCollection.items.length > 0 ||
          caseStudy.relatedContactsCollection.items.length > 0 ||
          caseStudy.relatedOrgsCollection.items.length > 0
        "
        fxLayout="column"
        fxFlex="20%"
        fxFlexOrder="1"
        fxFlexOrder.lt-md="2"
      >
        <h3 *ngIf="caseStudy?.relatedContactsCollection.items.length > 0">
          Contacts
          <hr />
        </h3>
        <app-contact-card
          *ngFor="let person of caseStudy.relatedContactsCollection.items"
          [person]="person"
        ></app-contact-card>

        <!-- Official Documents -->
        <h3 *ngIf="caseStudy?.relatedDocsCollection.items.length > 0">
          Documents
          <hr />
        </h3>
        <app-document-card
          *ngFor="let document of caseStudy.relatedDocsCollection.items"
          [document]="document"
        ></app-document-card>

        <h3 *ngIf="caseStudy?.relatedOrgsCollection.items.length > 0">
          Organisations
          <hr />
        </h3>
        <app-org-unit-card
          *ngFor="let orgUnit of caseStudy.relatedOrgsCollection.items"
          [orgUnit]="orgUnit"
        ></app-org-unit-card>
      </div>

      <!-- Related items -->
      <div
        *ngIf="caseStudy.relatedItemsCollection.items.length > 0"
        fxLayout="column"
        fxFlex="20%"
        fxFlexOrder="3"
      >
        <h3>
          Explore Related
          <hr />
        </h3>
        <app-standard-card
          id="you-might-be-interested-in"
          *ngFor="let content of caseStudy.relatedItemsCollection.items"
          [contentItem]="content"
        ></app-standard-card>
      </div>
    </div>
  </div>
</div>
